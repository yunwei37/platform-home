(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12],{12400:(e,t,n)=>{Promise.resolve().then(n.bind(n,95825))},95825:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m});var a=n(57437),s=n(2265);async function o(e){try{let t=await fetch("/api/genstruct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({markdown:e})});if(!t.ok)throw Error("Failed to clean content: ".concat(t.statusText));return await t.json()}catch(e){throw console.error("Error cleaning content:",e),Error("Failed to clean content: ".concat(e.message))}}let l=(e,t)=>t+"\n\n"+"来源：".concat(e.source," 日期：").concat(e.date);var c=n(8169),r=n(28148),i=n(46535);function d(e){let{title:t,content:n,isFolded:s,onFoldToggle:o,onContentChange:l,height:d=300,actions:h,info:u}=e;return(0,a.jsxs)("div",{className:"mt-6 rounded-lg bg-white p-6 shadow",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:t}),(0,a.jsx)("button",{onClick:o,className:"rounded p-1 hover:bg-gray-100",children:s?(0,a.jsx)(c.Z,{className:"h-5 w-5"}):(0,a.jsx)(r.Z,{className:"h-5 w-5"})})]}),!s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.ZP,{value:n,onChange:l,height:d}),(h||u)&&(0,a.jsxs)("div",{className:"mt-4 flex justify-between text-sm text-gray-500",children:[u,h]})]})]})}var h=n(92259),u=n.n(h);async function x(e){try{let t="/api/fetchurl?url=".concat(encodeURIComponent(e)),n=await u()(t);if(!n.ok)throw Error("Failed to fetch: ".concat(n.statusText));return{content:await n.text(),date:new Date().toLocaleDateString(),source:e}}catch(e){throw Error("Failed to crawl URL: ".concat(e.message))}}function g(){let[e,t]=(0,s.useState)(""),[n,c]=(0,s.useState)(!1),[r,i]=(0,s.useState)(null),[h,u]=(0,s.useState)(""),[g,m]=(0,s.useState)(""),[b,w]=(0,s.useState)({crawlResults:!1,cleanedContent:!1,taggedContent:!1}),p=async()=>{c(!0);try{let t=await x(e);i(t)}catch(e){console.error("Crawl failed:",e)}finally{c(!1)}},f=e=>{w(t=>({...t,[e]:!t[e]}))},j=async()=>{if(r){c(!0);try{let e=await o(r.content);u(e)}catch(e){console.error("Content cleaning failed:",e)}finally{c(!1)}}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"rounded-lg bg-white p-6 shadow",children:[(0,a.jsx)("h2",{className:"mb-4 text-xl font-semibold",children:"网站存档"}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("input",{type:"url",value:e,onChange:e=>t(e.target.value),placeholder:"Enter website URL",className:"flex-1 rounded border px-4 py-2"}),(0,a.jsx)("button",{onClick:p,disabled:n,className:"rounded bg-blue-600 px-6 py-2 text-white hover:bg-blue-700 disabled:opacity-50",children:n?"Crawling...":"Start Crawl"})]})]}),r&&(0,a.jsx)(d,{title:"爬取结果编辑",content:r.content,isFolded:b.crawlResults,onFoldToggle:()=>f("crawlResults"),onContentChange:e=>i({...r,content:e||""}),info:(0,a.jsxs)("span",{children:["来源: ",r.source]}),actions:(0,a.jsx)("button",{onClick:j,className:"rounded bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:"AI Clean"})}),h&&(0,a.jsx)(d,{title:"AI 清理后的内容",content:h,isFolded:b.cleanedContent,onFoldToggle:()=>f("cleanedContent"),onContentChange:e=>u(e||""),actions:(0,a.jsx)("button",{onClick:()=>{r&&m(l(r,h))},disabled:!h,className:"rounded bg-purple-600 px-4 py-2 text-white hover:bg-purple-700 disabled:opacity-50",children:"AI Tag"})}),g&&(0,a.jsx)(d,{title:"AI 标签与摘要",content:g,isFolded:b.taggedContent,onFoldToggle:()=>f("taggedContent"),onContentChange:e=>m(e||""),height:400})]})}function m(){return(0,a.jsxs)("div",{className:"mx-auto max-w-4xl p-6",children:[(0,a.jsx)("h1",{className:"mb-6 text-2xl font-bold",children:"URL 采集"}),(0,a.jsx)(g,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[890,591,130,215,744],()=>t(12400)),_N_E=e.O()}]);